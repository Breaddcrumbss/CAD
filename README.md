# Roti Proa CAD models

## Features

The boat models are programmed in Python.
All components are specified in software, in `src` as the _single source of truth_. Features include:
- Main macro: The boats is generated by the macro `src/RotiProa.FCMacro` which also generates statistics and a view.
- Parameters: The boat is fully parameterized; the files `src/boats/RP*.py` let you choose the numbers of solar panels and the size of all components.
- Configurations: Moving parts such as rig, sails, rudders etc can be configured in the files `src/configurations/*.py`, for example `CloseHaul.py`.
- Mirroring: Roti Proa has a transversal symmetry axis. Most components are described in file `mirror.py` and automatically mirrored in the generated model.
- Rotation: Some parts such as the rigs and rudder can be rotated, see file `rotation.py`. The rotation angles are specified 

## Getting Started

1. Clone this repository

2. Install [FreeCAD](https://www.freecad.org/)

3. Start FreeCAD

4. Macro > Macros, then choose the file `src/RotiProa.FCMacro`

5. You should see Roti Proa II in the FreeCAD view

## Playing with the FreeCAD GUI

- Play with `src/boats/RP2.py`: change parameters such as the number of solar panels, length of the boat, etc and rerun the macro to see the result.
- Play with `src/boats/CloseHaul.py`: change the sail settings and rerun the macro to see the result.

## Generating `FCStd` files from command line

[For this, you need to have a working `make` utility. Currently tested only on Mac; feel free to try this on Windows and let us know your results, using a PR or issue.]

To generate all files (all boat designs with all configurations) just type
```
make
```
Or to generate an individual `FCStd` file type
```
make build BOAT=RP2 CONFIG=CloseHaul
```
The generated files are placed in the folder `output`, for example:
```
output/RotiProa_RP2_CloseHaul.FCStd
```

## Under the hood

Crucial for the CICD approach to CAD using FreeCAD is:
- FreeCAD's (macros)[https://wiki.freecad.org/Macros] feature
- the ability to run FreeCAD headless, using `freecadcmd` on Linux and using `--console` on Mac
- this (observation)[https://forum.freecad.org/viewtopic.php?p=857226#p857226] by FreeCAD user (jcsahnwaldt)[https://forum.freecad.org/memberlist.php?mode=viewprofile&u=85580&sid=a9af5bd37412a3771f25378b4c027a2c] to use GUI features in headless FreeCAD with `PySide.QtGui`

Some design decisions:
- Toolchain automation with (`make`)[https://en.wikipedia.org/wiki/Make_(software)] using this (Makefile)[https://github.com/roti-proa/CAD/blob/main/Makefile]
- Website generation using (Jekyll)[https://en.wikipedia.org/wiki/Jekyll_(software)]
- YAML statistics generated by headless FreeCAD
- Rendering by headless FreeCAD using `jcsahnwaldt`'s observation

## Further development

Let's explore what output formats and we can generate and what tools are available to get the most out of our FreeCAD designs. Any contributions are welcome.
